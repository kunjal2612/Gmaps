<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>G - Map</title>
	<script type="text/javascript">
	    // This example creates a simple polygon representing the Bermuda Triangle.

	    function initMap() {
	        var map = new google.maps.Map(document.getElementById('map'), {
	            zoom: 5,
	            center: { lat: 43.688965237075685, lng: -79.30903534087781 },
	            mapTypeId: 'terrain'
	        });

			google.maps.event.addListener(map, 'click', function( event ){
				console.log("{ lat:"+event.latLng.lat()+", lng:"+event.latLng.lng()+"},");
			});

	        var icons = {
	            parking: {
	                icon: 'Images/man.png'
	            },
	            library: {
	                icon: 'Images/library_maps.png'
	            },
	            info: {
	                icon: 'Images/man.png',
                }
	        };

	        var features = [
                     {
                         position: new google.maps.LatLng(24.886,-70.268),
                         type: 'info',

                     },
                     {
                         position: new google.maps.LatLng(26.886, -71.268),
                         type: 'info',

                     },
                     {
                         position: new google.maps.LatLng(27.886, -71.268),
                         type: 'info',
                     }
               ];

	        // Create markers.
	        for (var i = 0; i < features.length; i++) {
	            var marker = new google.maps.Marker({
	                position: features[i].position,
                       icon: icons[features[i].type].icon,
	                map: map
	         });

                var infowindow = new google.maps.InfoWindow()
                var content="Abhishek Pujara"+i;
                google.maps.event.addListener(marker,'click', (function(marker,content,infowindow){
                       return function() {
                                           infowindow.setContent(content);
                                           infowindow.open(map,marker);
                                         };
                })(marker,content,infowindow));
	        };

            

	        var coords = [
						{ lat:43.60449855343088, lng:-79.51914886626844},
                        { lat:43.617424680945895, lng:-79.50678924712781},
						{ lat:43.63134201905249, lng:-79.48618988189344},
						{ lat:43.63730560618814, lng:-79.44361786040906},
						{ lat:43.641281002161335, lng:-79.35710052642469},
						{ lat:43.641281002161335, lng:-79.32688812408094}
					
						
					];

	        var editablePolygon = new google.maps.Polygon({
	            paths: coords,
	            strokeColor: '#FF0000',
	            strokeOpacity: 0.8,
	            strokeWeight: 2,
	            fillColor: '#FF0000',
	            fillOpacity: 0.35,
	            editable: true,
	            draggable: true,
	            geodesic: true
	        });

	        editablePolygon.setMap(map);
        }

        function butClick(){
            var name = document.getElementById("name").innerHTML;
            var lat = document.getElementById("lat").innerHTML;
            var long = document.getElementById("long").innerHTML;
            var x = document.getElementById("dataTable").rows.length;
            var myLatlng = new google.maps.LatLng(lat,long);            

            var mapOptions = {
                zoom: 4,
                center: myLatlng
            }

            var map = new google.maps.Map(document.getElementById("map"), mapOptions);


            var arr = [];
            for(var i=0;i<x;i++){
                var xy = document.getElementById("dataTable").rows[i].cells;
                
                arr[i] = [xy[1].innerHTML,xy[2].innerHTML,xy[0].innerHTML]
                LoadMarkers(xy[1].innerHTML,xy[2].innerHTML,xy[0].innerHTML);
            }

            for(var i=0;i<arr.length;i++){
                var ar = arr[i];
                var myLatlng = new google.maps.LatLng(ar[0],ar[1]); 
                console.log(ar[0]+" ----- "+ar[1]);
                var marker = new google.maps.Marker({
                    position: myLatlng,
                    map: map,
                    title: ar[2],
                })
            }
        }

	</script>

	<style type="text/css">
		body{height:100vh;width:100vw;}
		#map{height:100%;width:80%;}
	</style>
</head>
<body>
	<div id="map"></div>
    <table id="dataTable" border="1">
        <tr>
            <th>Name</th>
            <th>Lat</th>
            <th>Long</th>
            <th>empTarget</th>
            <th>empTargetAch</th>
            <th>ContactNo</th>
             <th>Sales Ratio</th>

            
        </tr>
        {{#each data}}
            {{!-- <input type="text" value="" id="name"/>
            <input type="text" value="" id="lat"/>
            <input type="text" value="" id="long"/>
             <input type="text" value="" id="empTarget"/>
              <input type="text" value="" id="empTarAch"/>
            <input type="text" value="" id="salesRatio"/> --}}
            
            <tr>
                <td>{{this.name}}</td>
                <td>{{this.lat}}</td>
                <td>{{this.long}}</td>
                <td>{{this.empTarget}}</td>
                <td>{{this.empTarAch}}</td>
                <td>{{this.contactNo}}</td>
                <td>{{divide this.empTarget this.empTarAch}}</td>
                
            </tr>
        {{/each}}
    </table>
    <input type="button" value="load markers" onclick="butClick()"/>
	<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBBoRszf_8fSb3PBBj3Q8uztW2fJiacgVQ&callback=initMap"></script>
                

</body>

</html>